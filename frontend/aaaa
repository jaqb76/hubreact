const { override, addWebpackAlias, addWebpackPlugin } = require('customize-cra');
const webpack = require('webpack');

module.exports = override(
  addWebpackAlias({
    "os": require.resolve("os-browserify/browser"),
    "stream": require.resolve("stream-browserify"),
    "process": require.resolve("process/browser"),
    "buffer": require.resolve("buffer"),
    "path": require.resolve("path-browserify")
  }),
  addWebpackPlugin(
    new webpack.ProvidePlugin({
      process: 'process/browser',
      Buffer: ['buffer', 'Buffer']
    })
  ),
  (config) => {
    if (!config.resolve) {
      config.resolve = {};
    }
    if (!config.resolve.fallback) {
      config.resolve.fallback = {};
    }
    
    // Make sure not to override any existing fallbacks
    Object.assign(config.resolve.fallback, {
      "os": require.resolve("os-browserify/browser"),
      "stream": require.resolve("stream-browserify"),
      "path": require.resolve("path-browserify"),
      "process": require.resolve("process/browser"),
      "buffer": require.resolve("buffer")
    });
    
    return config;
  }
);


npm install --save-dev os-browserify stream-browserify process buffer path-browserify


rm -rf node_modules/.cache

